{"_id":"@videojs/xhr","_rev":"19-fab1505b885fe09d55d43bacddbc6535","name":"@videojs/xhr","dist-tags":{"experimental":"2.5.1","latest":"2.7.0"},"versions":{"2.5.1":{"name":"@videojs/xhr","version":"2.5.1","keywords":["xhr","http","xmlhttprequest","xhr2","browserify"],"author":{"name":"Raynos","email":"raynos2@gmail.com"},"license":"MIT","_id":"@videojs/xhr@2.5.1","maintainers":[{"name":"mmcc","email":"matt@mmcc.io"},{"name":"squarebracket","email":"chuck.wilson+github@gmail.com"},{"name":"tjaneczko","email":"tjaneczko@brightcove.com"},{"name":"gkatsev","email":"me@gkatsev.com"},{"name":"heff","email":"npm@heff.me"},{"name":"mmcclure","email":"npm@htbx.net"},{"name":"dmlap","email":"dlapalomento@gmail.com"},{"name":"misteroneill","email":"pgoneill@gmail.com"},{"name":"brandonocasey","email":"brandonocasey@gmail.com"},{"name":"forbesjo","email":"joseph.a.forbes@gmail.com"},{"name":"gesinger","email":"gesinger@gmail.com"},{"name":"imbcmdth","email":"jon.carlos.rivera@gmail.com"},{"name":"incompl","email":"gsmith@incompl.com"},{"name":"mjneil","email":"mneilweb@gmail.com"},{"name":"okaramian","email":"okaramia@gmail.com"},{"name":"lday","email":"ldayananda@brightcove.com"},{"name":"misterben","email":"npm@misterben.me"}],"contributors":[{"name":"Jake Verbaten"},{"name":"Zbyszek Tenerowicz","email":"naugtur@gmail.com"}],"homepage":"https://github.com/naugtur/xhr","bugs":{"url":"https://github.com/naugtur/xhr/issues","email":"naugtur@gmail.com"},"dist":{"shasum":"26bc5a79dbb3b03bfb13742c6ce559f89e90719e","tarball":"https://registry.npmjs.org/@videojs/xhr/-/xhr-2.5.1.tgz","fileCount":6,"integrity":"sha512-wV9nGESHseSK+S9ePEru2+OJZ1jq/ZbbzniGQ4weAmTIepuBMSYPx5zrxxQA0E786T5ykpO8ts+LayV+3/oI2w==","signatures":[{"sig":"MEUCIQCc9acN4h7F0VzWudMKENSQDySp68S3COyZSjW1hEgx7AIgB8ZNSYoNFK9RwhXOpu7XUevwGdaHOc6u3OvWqMjgFQg=","keyid":"SHA256:jl3bwswu80PjjokCgh0o2w5c2U4LhQAE57gj9cz1kzA"}],"unpackedSize":22357,"npm-signature":"-----BEGIN PGP SIGNATURE-----\r\nVersion: OpenPGP.js v3.0.4\r\nComment: https://openpgpjs.org\r\n\r\nwsFcBAEBCAAQBQJdaEIVCRA9TVsSAnZWagAAnocP+gJPVoLB3WKHvylxcJKD\noXAxj2hl5bpOF0GtppcLArV2FDMhTdY5QUemRuN6td/JAqTyiYV5/rdRKLtb\n6+LqSkBOqFI1zFRjbpGO7qsdiBexHxWpR/rmUBIfvFkjdkY3UHApVAXYFfT2\nLLGB70ycYnHl/B6jrl3SLUyyZSgZzx1UER7Q8zLirioY9ko/FSaiK3RA+6Zu\n595JnQJbFCkeuNHdsxb523ujBPwFElPiffCzHUIS6b1+t6ACcJywJjhDqaJH\nfzbxjEzmMjf+gfvnw3D4OK4B7vpJa198zEPoC2WnprLgEs9EPMRIPKPgttoV\nLSAhsmMOgXeyVc0BEWISbnZPFco8bZhaZh8dAvGT8o2vpgQhBR01DUbng6S6\nvBSObv8cdj1mcsR6fdACoZyfwpW9w3bzsBZH9eJJeBjEDO48yUrJcL3zrAkS\nLDigzEA8uwaR7dVKq1eeIup/4y8z0SSuml7da9Eh2291P8A/nHFRfx8He3h2\n9v3+kHYN36U29U4JSCIz8affF1CNXkbUV+Tj+/p63WapnEotlakznPHgbVe4\nTl4N3qbdKTdPExjuEHr045ncVmzjXe8skU+gE9El6F0VDUDfh+d7lzsAZdQo\nxZU3ekH++EzmfNI59/8CHYGmoVDrksXW4f2IUsXmxHvODb5/utJkCzkqsD+/\n9b/n\r\n=i+WC\r\n-----END PGP SIGNATURE-----\r\n"},"main":"index","gitHead":"2fb3a390da6ff184b41b792cb11d6690a9b4cec1","scripts":{"test":"run-browser test/index.js -b -m test/mock-server.js | tap-spec","browser":"run-browser -m test/mock-server.js test/index.js"},"typings":"./index.d.ts","_npmUser":{"name":"brandonocasey","email":"brandonocasey@gmail.com"},"repository":{"url":"git://github.com/naugtur/xhr.git","type":"git"},"_npmVersion":"6.4.1","description":"small xhr abstraction","directories":{},"_nodeVersion":"10.15.3","dependencies":{"global":"~4.4.0","is-function":"^1.0.1","@babel/runtime":"^7.5.5"},"_hasShrinkwrap":false,"devDependencies":{"tape":"^4.0.0","for-each":"^0.3.2","tap-spec":"^4.0.2","pre-commit":"1.2.2","run-browser":"github:naugtur/run-browser"},"_npmOperationalInternal":{"tmp":"tmp/xhr_2.5.1_1567113748555_0.021833403815311847","host":"s3://npm-registry-packages"}},"2.6.0":{"name":"@videojs/xhr","version":"2.6.0","keywords":["xhr","http","xmlhttprequest","xhr2","browserify"],"author":{"name":"Raynos","email":"raynos2@gmail.com"},"license":"MIT","_id":"@videojs/xhr@2.6.0","maintainers":[{"name":"squarebracket","email":"chuck.wilson+github@gmail.com"},{"name":"tjaneczko","email":"tjaneczko@brightcove.com"},{"name":"gkatsev","email":"me@gkatsev.com"},{"name":"heff","email":"npm@heff.me"},{"name":"mmcclure","email":"npm@htbx.net"},{"name":"dmlap","email":"dlapalomento@gmail.com"},{"name":"misteroneill","email":"pgoneill@gmail.com"},{"name":"brandonocasey","email":"brandonocasey@gmail.com"},{"name":"forbesjo","email":"joseph.a.forbes@gmail.com"},{"name":"gesinger","email":"gesinger@gmail.com"},{"name":"imbcmdth","email":"jon.carlos.rivera@gmail.com"},{"name":"incompl","email":"gsmith@incompl.com"},{"name":"mjneil","email":"mneilweb@gmail.com"},{"name":"okaramian","email":"okaramia@gmail.com"},{"name":"lday","email":"ldayananda@brightcove.com"},{"name":"misterben","email":"npm@misterben.me"},{"name":"mmcc","email":"matt@mmcc.io"},{"name":"abarstow","email":"alexander.barstow@gmail.com"}],"contributors":[{"name":"Jake Verbaten"},{"name":"Zbyszek Tenerowicz","email":"naugtur@gmail.com"}],"homepage":"https://github.com/videojs/xhr","bugs":{"url":"https://github.com/videojs/xhr/issues"},"dist":{"shasum":"cd897e0ad54faf497961bcce3fa16dc15a26bb80","tarball":"https://registry.npmjs.org/@videojs/xhr/-/xhr-2.6.0.tgz","fileCount":11,"integrity":"sha512-7J361GiN1tXpm+gd0xz2QWr3xNWBE+rytvo8J3KuggFaLg+U37gZQ2BuPLcnkfGffy2e+ozY70RHC8jt7zjA6Q==","signatures":[{"sig":"MEUCIGv8mVvpAAyTHoOEHuh0ZgFycYxywGUDaVlnklMiJvNCAiEAs8F0zr9+l+iY6LQkfIfw4MXD3V9S+EW7qBq8aLqmt20=","keyid":"SHA256:jl3bwswu80PjjokCgh0o2w5c2U4LhQAE57gj9cz1kzA"}],"unpackedSize":36366,"npm-signature":"-----BEGIN PGP SIGNATURE-----\r\nVersion: OpenPGP.js v3.0.13\r\nComment: https://openpgpjs.org\r\n\r\nwsFcBAEBCAAQBQJg/0XKCRA9TVsSAnZWagAAgpYP/jcnJYwU9NJigm5X7gAq\nJVnKQYAJdxOT8DtsXZK0JdkcBZY9tLaI+D8T0sWMQCZDAr7iRSMbUJfSsaIJ\nA28haQUex2lQi6fZ0KhCiQL94aKbDmV0xNO+SOYQPtvUlvL0zZP7VfSWwObN\n1p/CJOeQG3jaqoh+/ZMl3ifFHjMaqOHqOhLOjEoCsh+kNo26eNtIS53c7UOZ\n/yySshToa4hDcng0dUFAPUY1I/mT3Hr2nlmvdxq//g2HGZ0Pjj5+TkdJxPYY\nraiRW3+KamDb3JGMeGOkD6sy841zyHYLpzyrvUskffnOhJmDObZC4jbrOxWz\nNXcfjuoQqFH4FnWkiMybcUXlEMmMEv+zv6KJEE4WVQQtZfVjbbP6J5d21IPr\n/My5P+jM4aYTLBX38AGsVbQwPYUVGgCWEbtDEq5z4PlQ40MFOGxcS8I1dXKe\n1S5DCCRQDJ/0pvpXkOpydAlH3rdFVJxdU6AtttxCPR8qxAHAsXkGkmzXXLP1\ngA8wAZsX0NuzvVXuXsNR5ESg6rn2TVqCkdiRDw+I/dadVnN6ORTpj6IFaglC\neGLJXyHpN7FFDdQE01gvKlMsdzoIplympP9OsOKFlAsx2rQbrXauekyXp5A/\nrhbEqiVcFiw0EkUi5lqgtLkWq/AKmsteC0CumaERR23N1OMvQb5L4nYNId2W\n071X\r\n=Kcq5\r\n-----END PGP SIGNATURE-----\r\n"},"main":"./lib/index.js","gitHead":"b6a39f2ba85d552ce9c46c407007a79ab970acfc","scripts":{"test":"npm run test:index && npm run test:http-handler","build":"babel-config-cjs src -d lib","start":"npm run build -- -w","browser":"run-browser -m test/mock-server.js test/index.js","pretest":"npm run build","test:index":"run-browser test/index.js -b -m test/mock-server.js | tap-spec","prepublishOnly":"npm run build","test:http-handler":"run-browser test/http-handler.js -b -m test/mock-server.js | tap-spec"},"typings":"./lib/index.d.ts","_npmUser":{"name":"gkatsev","email":"me@gkatsev.com"},"repository":{"url":"git://github.com/videojs/xhr.git","type":"git"},"_npmVersion":"6.14.12","description":"small xhr abstraction","directories":{},"_nodeVersion":"10.24.1","dependencies":{"global":"~4.4.0","is-function":"^1.0.1","@babel/runtime":"^7.5.5"},"_hasShrinkwrap":false,"devDependencies":{"tape":"^4.0.0","for-each":"^0.3.2","tap-spec":"^5.0.0","@babel/cli":"^7.14.8","pre-commit":"1.2.2","@babel/core":"^7.14.8","run-browser":"github:naugtur/run-browser","@babel/preset-env":"^7.14.8","@videojs/babel-config":"^0.1.0"},"_npmOperationalInternal":{"tmp":"tmp/xhr_2.6.0_1627342281988_0.3741377777186612","host":"s3://npm-registry-packages"}},"2.7.0":{"name":"@videojs/xhr","version":"2.7.0","keywords":["xhr","http","xmlhttprequest","xhr2","browserify"],"author":{"name":"Raynos","email":"raynos2@gmail.com"},"license":"MIT","_id":"@videojs/xhr@2.7.0","maintainers":[{"name":"phale","email":"phale@brightcove.com"},{"name":"ddashkevich","email":"ddashkevich@brightcove.com"},{"name":"roman-bc","email":"rpougatchev@brightcove.com"},{"name":"walterseymourbc","email":"wseymour@brightcove.com"},{"name":"videojs-user","email":"videojs@gkatsev.com"},{"name":"usmanonazim","email":"usmanonazim@gmail.com"},{"name":"mmcclure","email":"npm@htbx.net"},{"name":"misteroneill","email":"pgoneill@gmail.com"},{"name":"misterben","email":"npm@misterben.me"},{"name":"lday","email":"ldayananda@brightcove.com"},{"name":"imbcmdth","email":"jon.carlos.rivera@gmail.com"},{"name":"hswaminathan","email":"hswaminathan@brightcove.com"},{"name":"heff","email":"npm@heff.me"},{"name":"gkatsev","email":"me@gkatsev.com"},{"name":"gesinger","email":"gesinger@gmail.com"},{"name":"essk","email":"sarah@teaandbiscuits.net"},{"name":"dmlap","email":"dlapalomento@gmail.com"},{"name":"brandonocasey","email":"brandonocasey@gmail.com"},{"name":"awaldron","email":"awaldron@brightcove.com"},{"name":"abarstow","email":"alexander.barstow@gmail.com"}],"contributors":[{"name":"Jake Verbaten"},{"name":"Zbyszek Tenerowicz","email":"naugtur@gmail.com"}],"homepage":"https://github.com/videojs/xhr","bugs":{"url":"https://github.com/videojs/xhr/issues"},"dist":{"shasum":"e272af6e2b5448aeb400905a5c6f4818f6b6ad47","tarball":"https://registry.npmjs.org/@videojs/xhr/-/xhr-2.7.0.tgz","fileCount":18,"integrity":"sha512-giab+EVRanChIupZK7gXjHy90y3nncA2phIOyG3Ne5fvpiMJzvqYwiTOnEVW2S4CoYcuKJkomat7bMXA/UoUZQ==","signatures":[{"sig":"MEQCIAmcBJoqtfF2V18vlXDxQN2b3h8U+trpYXmhcoEl58UpAiA7XtIJ7CyqqWbpAdOkGf0UBxzSLQXPdNP7Ho7p6aGqBQ==","keyid":"SHA256:jl3bwswu80PjjokCgh0o2w5c2U4LhQAE57gj9cz1kzA"}],"unpackedSize":60072},"main":"./lib/index.js","gitHead":"2aa63ccc2761187236b760edf71564db3258936f","scripts":{"test":"npm run test:index && npm run test:http-handler && npm run test:interceptors && npm run test:retry","build":"babel-config-cjs src -d lib","start":"npm run build -- -w","browser":"run-browser -m test/mock-server.js test/index.js","pretest":"npm run build","test:index":"run-browser test/index.js -b -m test/mock-server.js | tap-spec","test:retry":"run-browser test/retry.js -b -m test/mock-server.js | tap-spec","prepublishOnly":"npm run build","test:http-handler":"run-browser test/http-handler.js -b -m test/mock-server.js | tap-spec","test:interceptors":"run-browser test/interceptors.js -b -m test/mock-server.js | tap-spec"},"typings":"./lib/index.d.ts","_npmUser":{"name":"ddashkevich","email":"ddashkevich@brightcove.com"},"repository":{"url":"git://github.com/videojs/xhr.git","type":"git"},"_npmVersion":"6.14.12","description":"small xhr abstraction","directories":{},"_nodeVersion":"10.24.1","dependencies":{"global":"~4.4.0","is-function":"^1.0.1","@babel/runtime":"^7.5.5"},"_hasShrinkwrap":false,"devDependencies":{"tape":"^4.0.0","for-each":"^0.3.2","tap-spec":"^5.0.0","@babel/cli":"^7.14.8","pre-commit":"1.2.2","@babel/core":"^7.14.8","run-browser":"github:naugtur/run-browser","@babel/preset-env":"^7.14.8","@videojs/babel-config":"^0.1.0"},"_npmOperationalInternal":{"tmp":"tmp/xhr_2.7.0_1717711331462_0.7733782370403268","host":"s3://npm-registry-packages"}}},"time":{"created":"2019-08-29T21:22:28.427Z","modified":"2025-11-09T19:03:14.629Z","2.5.1":"2019-08-29T21:22:28.697Z","2.6.0":"2021-07-26T23:31:22.135Z","2.7.0":"2024-06-06T22:02:11.749Z"},"bugs":{"url":"https://github.com/videojs/xhr/issues"},"author":{"name":"Raynos","email":"raynos2@gmail.com"},"license":"MIT","homepage":"https://github.com/videojs/xhr","keywords":["xhr","http","xmlhttprequest","xhr2","browserify"],"repository":{"url":"git://github.com/videojs/xhr.git","type":"git"},"description":"small xhr abstraction","contributors":[{"name":"Jake Verbaten"},{"name":"Zbyszek Tenerowicz","email":"naugtur@gmail.com"}],"maintainers":[{"email":"ronaldu@qualabs.com","name":"ronaldqualabs"},{"email":"cpillsbury@mux.com","name":"cpillsburymux"},{"email":"alexander.barstow@gmail.com","name":"abarstow"},{"email":"awaldron@brightcove.com","name":"awaldron"},{"email":"brandonocasey@gmail.com","name":"brandonocasey"},{"email":"sarah@teaandbiscuits.net","name":"essk"},{"email":"gesinger@gmail.com","name":"gesinger"},{"email":"me@gkatsev.com","name":"gkatsev"},{"email":"npm@heff.me","name":"heff"},{"email":"hswaminathan@brightcove.com","name":"hswaminathan"},{"email":"jon.carlos.rivera@gmail.com","name":"imbcmdth"},{"email":"ldayananda@brightcove.com","name":"lday"},{"email":"pgoneill@gmail.com","name":"misteroneill"},{"email":"npm@htbx.net","name":"mmcclure"},{"email":"usmanonazim@gmail.com","name":"usmanonazim"},{"email":"videojs@gkatsev.com","name":"videojs-user"},{"email":"ddashkevich@brightcove.com","name":"ddashkevich"},{"email":"phale@brightcove.com","name":"phale"}],"readme":"# xhr\n\n> Originally forked from [naugtur/xhr](https://github.com/naugtur/xhr).\n\nA small XMLHttpRequest wrapper. Designed for use with [browserify](http://browserify.org/), [webpack](https://webpack.github.io/) etc.\n\nAPI is a subset of [request](https://github.com/request/request) so you can write code that works in both node.js and the browser by using `require('request')` in your code and telling your browser bundler to load `xhr` instead of `request`.\n\nFor browserify, add a [browser](https://github.com/substack/node-browserify#browser-field) field to your `package.json`:\n\n```\n\"browser\": {\n  \"request\": \"@videojs/xhr\"\n}\n```\n\nFor webpack, add a [resolve.alias](http://webpack.github.io/docs/configuration.html#resolve-alias) field to your configuration:\n\n```\n\"resolve\": {\n  \"alias\": {\n    \"request$\": \"@videojs/xhr\"\n  }\n}\n```\n\nBrowser support: IE8+ and everything else.\n\n## Installation\n\n```\nnpm install @videojs/xhr\n```\n\n## Example\n\n```js\nvar xhr = require(\"@videojs/xhr\")\n\nxhr({\n    method: \"post\",\n    body: someJSONString,\n    uri: \"/foo\",\n    headers: {\n        \"Content-Type\": \"application/json\"\n    }\n}, function (err, resp, body) {\n    // check resp.statusCode\n})\n```\n\n## `var req = xhr(options, callback)`\n\n```js\ntype XhrOptions = String | {\n    useXDR: Boolean?,\n    sync: Boolean?,\n    uri: String,\n    url: String,\n    method: String?,\n    timeout: Number?,\n    headers: Object?,\n    body: String? | Object?,\n    json: Boolean? | Object?,\n    username: String?,\n    password: String?,\n    withCredentials: Boolean?,\n    responseType: String?,\n    beforeSend: Function?\n}\nxhr := (XhrOptions, Callback<Response>) => Request\n```\nthe returned object is either an [`XMLHttpRequest`][3] instance\n    or an [`XDomainRequest`][4] instance (if on IE8/IE9 &&\n    `options.useXDR` is set to `true`)\n\n### XhrCallback\n\nYour callback will be called once with the arguments\n    ( [`Error`][5], `response` , `body` ) where the response is an object:\n```js\n{\n    body: Object||String,\n    statusCode: Number,\n    method: String,\n    headers: {},\n    url: String,\n    rawRequest: xhr\n}\n```\n - `body`: HTTP response body - [`XMLHttpRequest.response`][6], [`XMLHttpRequest.responseText`][7] or\n    [`XMLHttpRequest.responseXML`][8] depending on the request type.\n - `rawRequest`: Original  [`XMLHttpRequest`][3] instance\n    or [`XDomainRequest`][4] instance (if on IE8/IE9 &&\n    `options.useXDR` is set to `true`)\n - `headers`: A collection of headers where keys are header names converted to lowercase\n\n\nYour callback will be called with an [`Error`][5] if there is an error in the browser that prevents sending the request.\nA HTTP 500 response is not going to cause an error to be returned.\n\n## Other signatures\n\n* `var req = xhr(url, callback)` -\na simple string instead of the options. In this case, a GET request will be made to that url.\n\n* `var req = xhr(url, options, callback)` -\nthe above may also be called with the standard set of options.\n\n### Convience methods\n* `var req = xhr.{post, put, patch, del, head, get}(url, callback)`\n* `var req = xhr.{post, put, patch, del, head, get}(options, callback)`\n* `var req = xhr.{post, put, patch, del, head, get}(url, options, callback)`\n\nThe `xhr` module has convience functions attached that will make requests with the given method.\nEach function is named after its method, with the exception of `DELETE` which is called `xhr.del` for compatibility.\n\nThe method shorthands may be combined with the url-first form of `xhr` for succinct and descriptive requests. For example,\n\n```js\nxhr.post('/post-to-me', function(err, resp) {\n  console.log(resp.body)\n})\n```\n\nor\n\n```js\nxhr.del('/delete-me', { headers: { my: 'auth' } }, function (err, resp) {\n  console.log(resp.statusCode);\n})\n```\n\n## Options\n\n### `options.method`\n\nSpecify the method the [`XMLHttpRequest`][3] should be opened\n    with. Passed to [`XMLHttpRequest.open`][2]. Defaults to \"GET\"\n\n### `options.useXDR`\n\nSpecify whether this is a cross origin (CORS) request for IE<10.\n    Switches IE to use [`XDomainRequest`][4] instead of `XMLHttpRequest`.\n    Ignored in other browsers.\n\nNote that headers cannot be set on an XDomainRequest instance.\n\n### `options.sync`\n\nSpecify whether this is a synchrounous request. Note that when\n    this is true the callback will be called synchronously. In\n    most cases this option should not be used. Only use if you\n    know what you are doing!\n\n### `options.body`\n\nPass in body to be send across the [`XMLHttpRequest`][3].\n    Generally should be a string. But anything that's valid as\n    a parameter to [`XMLHttpRequest.send`][1] should work  (Buffer for file, etc.).\n\nIf `options.json` is `true`, then this must be a JSON-serializable object. `options.body` is passed to `JSON.stringify` and sent.\n\n### `options.uri` or `options.url`\n\nThe uri to send a request to. Passed to [`XMLHttpRequest.open`][2]. `options.url` and `options.uri` are aliases for each other.\n\n### `options.headers`\n\nAn object of headers that should be set on the request. The\n    key, value pair is passed to [`XMLHttpRequest.setRequestHeader`][9]\n\n### `options.timeout`\n\nNumber of miliseconds to wait for response. Defaults to 0 (no timeout). Ignored when `options.sync` is true.\n\n### `options.json`\n\nSet to `true` to send request as `application/json` (see `options.body`) and parse response from JSON.\n\nFor backwards compatibility `options.json` can also be a valid JSON-serializable value to be sent to the server. Additionally the response body is still parsed as JSON\n\nFor sending booleans as JSON body see FAQ\n\n### `options.withCredentials`\n\nSpecify whether user credentials are to be included in a cross-origin\n    request. Sets [`XMLHttpRequest.withCredentials`][10]. Defaults to false.\n\nA wildcard `*` cannot be used in the `Access-Control-Allow-Origin` header when `withCredentials` is true.\n    The header needs to specify your origin explicitly or browser will abort the request.\n\n### `options.responseType`\n\nDetermines the data type of the `response`. Sets [`XMLHttpRequest.responseType`][11]. For example, a `responseType` of `document` will return a parsed `Document` object as the `response.body` for an XML resource.\n\n### `options.beforeSend`\n\nA function being called right before the `send` method of the `XMLHttpRequest` or `XDomainRequest` instance is called. The `XMLHttpRequest` or `XDomainRequest` instance is passed as an argument.\n\n### `options.xhr`\n\nPass an `XMLHttpRequest` object (or something that acts like one) to use instead of constructing a new one using the `XMLHttpRequest` or `XDomainRequest` constructors. Useful for testing.\n\n## Helpers\n\nThis module exposes the following helpers on the `xhr` object.\n\n### `xhr.httpHandler(callback, decodeResponseBody) => XhrCallback`\n\n`httpHandler` is a wrapper for the [XhrCallback][] which returns an error for HTTP Status Codes 4xx and 5xx. Given a callback, it'll either return an error with the response body as the error's cause, or return the response body.\n\nUsage like so:\n```js\nxhr({\n    uri: \"https://example.com/foo\",\n    responseType: 'arraybuffer'\n}, xhr.httpHandler(function(err, responseBody) {\n\n  // we got an error if the XHR errored out or if the status code was 4xx/5xx\n  if (err) {\n    // error cause is coming soon to JavaScript https://github.com/tc39/proposal-error-cause\n    throw new Error(err, {cause: err.cause});\n  }\n\n  // this will log an ArrayBuffer\n  console.log(responseBody);\n});\n```\n\n```js\nxhr({\n    uri: \"https://example.com/foo\",\n    responseType: 'arraybuffer'\n}, xhr.httpHandler(function(err, responseBody) {\n\n  if (err) {\n    throw new Error(err, {cause: err.cause});\n  }\n\n  // in this case, responseBody will be a String\n  console.log(responseBody);\n},\n\n// passing true as the second argument will cause httpHandler try and decode the response body into a string\ntrue)\n```\n\n### `xhr.requestInterceptorsStorage` and `xhr.responseInterceptorsStorage`\n\nhave the following API:\n```typescript\nexport interface NetworkRequest {\n  headers: Record<string, string>;\n  uri: string;\n  metadata: Record<string, unknown>;\n  body?: unknown;\n  retry?: Retry;\n  timeout?: number;\n}\n\nexport interface NetworkResponse {\n  headers: Record<string, string>;\n  responseUrl: string;\n  body?: unknown;\n  responseType?: XMLHttpRequestResponseType;\n}\n\nexport type Interceptor<T> = (payload: T) => T;\n\nexport interface InterceptorsStorage<T> {\n  enable(): void;\n  disable(): void;\n  getIsEnabled(): boolean;\n  reset(): void;\n  addInterceptor(type: string, interceptor: Interceptor<T>): boolean;\n  removeInterceptor(type: string, interceptor: Interceptor<T>): boolean;\n  clearInterceptorsByType(type: string): boolean;\n  clear(): boolean;\n  getForType(type: string): Set<Interceptor<T>>;\n  execute(type: string, payload: T): T;\n}\n\n```\nUsage:\n\n```js\nxhr.requestInterceptorsStorage.enable();\nxhr.responseInterceptorsStorage.enable();\n\nxhr.requestInterceptorsStorage.addInterceptor('segment', (request) => {\n  // read / update NetworkRequest\n  return request;\n});\n\nxhr.responseInterceptorsStorage.addInterceptor('segement', (response) => {\n  // read / update NetworkResponse\n  return response;\n});\n\nxhr({\n  uri: 'https://host/segment',\n  responseType: 'arraybuffer',\n  requestType: 'segement'\n}, function(err, response, responseBody) {\n  // your callback\n});\n\n```\n\n### `xhr.retryManager`\n\nhas the following API\n\n```typescript\nexport interface Retry {\n  getCurrentDelay(): number;\n  getCurrentMinPossibleDelay(): number;\n  getCurrentMaxPossibleDelay(): number;\n  getCurrentFuzzedDelay(): number;\n  shouldRetry(): boolean;\n  moveToNextAttempt(): void;\n}\n\nexport interface RetryOptions {\n  maxAttempts?: number;\n  delayFactor?: number;\n  fuzzFactor?: number;\n  initialDelay?: number;\n}\n\nexport interface RetryManager {\n  enable(): void;\n  disable(): void;\n  reset(): void;\n  getMaxAttempts(): number;\n  setMaxAttempts(maxAttempts: number): void;\n  getDelayFactor(): number;\n  setDelayFactor(delayFactor: number): void;\n  getFuzzFactor(): number;\n  setFuzzFactor(fuzzFactor: number): void;\n  getInitialDelay(): number;\n  setInitialDelay(initialDelay: number): void;\n  createRetry(options?: RetryOptions): Retry;\n}\n```\n\nUsage:\n\n```js\nxhr.retryManager.enable();\n\nxhr.retryManager.setMaxAttempts(2);\n\nxhr({\n  uri: 'https://host/segment',\n  responseType: 'arraybuffer',\n  retry: xhr.retryManager.createRetry(),\n}, function(err, response, responseBody) {\n  // your callback\n});\n\n// or override values for specific request:\nxhr({\n  uri: 'https://host/segment',\n  responseType: 'arraybuffer',\n  retry: xhr.retryManager.createRetry({ maxAttempts: 3 }),\n}, function(err, response, responseBody) {\n  // your callback\n});\n\n\n// you can combine interceptors/retry APIs if you dont have direct acces to the request:\nxhr.requestInterceptorsStorage.addInterceptor('segment', (request) => {\n  // read / update NetworkRequest\n  request.retry = xhr.retryManager.createRetry();\n  return request;\n});\n\n\n```\n\n\n## FAQ\n\n- Why is my server's JSON response not parsed? I returned the right content-type.\n  - See `options.json` - you can set it to `true` on a GET request to tell `xhr` to parse the response body.\n  - Without `options.json` body is returned as-is (a string or when `responseType` is set and the browser supports it - a result of parsing JSON or XML)\n- How do I send an object or array as POST body?\n  - `options.body` should be a string. You need to serialize your object before passing to `xhr` for sending.\n  - To serialize to JSON you can use\n   `options.json:true` with `options.body` for convenience - then `xhr` will do the serialization and set content-type accordingly.\n- Where's stream API? `.pipe()` etc.\n  - Not implemented. You can't reasonably have that in the browser.\n- Why can't I send `\"true\"` as body by passing it as `options.json` anymore?\n  - Accepting `true` as a value was a bug. Despite what `JSON.stringify` does, the string `\"true\"` is not valid JSON. If you're sending booleans as JSON, please consider wrapping them in an object or array to save yourself from more trouble in the future. To bring back the old behavior, hardcode `options.json` to `true` and set `options.body` to your boolean value.\n- How do I add an `onprogress` listener?\n  - use `beforeSend` function for non-standard things that are browser specific. In this case:\n  ```js\n  xhr({\n    ...\n    beforeSend: function(xhrObject){\n      xhrObject.onprogress = function(){}\n    }\n  })\n  ```\n\n## Mocking Requests\nYou can override the constructor used to create new requests for testing. When you're making a new request:\n\n```js\nxhr({ xhr: new MockXMLHttpRequest() })\n```\n\nor you can override the constructors used to create requests at the module level:\n\n```js\nxhr.XMLHttpRequest = MockXMLHttpRequest\nxhr.XDomainRequest = MockXDomainRequest\n```\n\n## MIT Licenced\n\n  [1]: http://xhr.spec.whatwg.org/#the-send()-method\n  [2]: http://xhr.spec.whatwg.org/#the-open()-method\n  [3]: http://xhr.spec.whatwg.org/#interface-xmlhttprequest\n  [4]: http://msdn.microsoft.com/en-us/library/ie/cc288060(v=vs.85).aspx\n  [5]: http://es5.github.com/#x15.11\n  [6]: http://xhr.spec.whatwg.org/#the-response-attribute\n  [7]: http://xhr.spec.whatwg.org/#the-responsetext-attribute\n  [8]: http://xhr.spec.whatwg.org/#the-responsexml-attribute\n  [9]: http://xhr.spec.whatwg.org/#the-setrequestheader()-method\n  [10]: http://xhr.spec.whatwg.org/#the-withcredentials-attribute\n  [11]: https://xhr.spec.whatwg.org/#the-responsetype-attribute\n","readmeFilename":"README.md"}